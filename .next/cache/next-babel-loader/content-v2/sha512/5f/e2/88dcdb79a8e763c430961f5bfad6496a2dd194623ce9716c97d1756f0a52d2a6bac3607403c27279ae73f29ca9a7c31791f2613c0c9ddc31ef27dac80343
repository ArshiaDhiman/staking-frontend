{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/Arshia Dhiman/Solidity-Staking-Project/staking-frontend/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/Arshia Dhiman/Solidity-Staking-Project/staking-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { createSlice } from \"@reduxjs/toolkit\";\nimport { STAKING_ADDRESS } from \"src/constants\";\nimport ABI from \"src/abi/Staking.json\";\nimport { getContract } from \"src/utils\"; // Define a type for the slice state\n\n// Define the initial state using that type\nvar initialState = {\n  pools: []\n};\nexport var stakingSlice = createSlice({\n  name: \"staking\",\n  // `createSlice` will infer the state type from the `initialState` argument\n  initialState: initialState,\n  reducers: {\n    setPools: function setPools(state, action) {\n      state.pools = action.payload;\n    }\n  }\n}); // whatever function the thunk returns should use .then (can't await)\n\nexport var updatePools = function updatePools(account) {\n  return function (dispatch) {\n    var staking = getContract(STAKING_ADDRESS, ABI); // eslint-disable-next-line\n\n    staking.getPools().then( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_pools) {\n        var pools;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return Promise.all(_pools.map( /*#__PURE__*/function () {\n                  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref2, id) {\n                    var poolName, rewardRate, lockPeriod, totalStaked, user_info, user_amount, user_reward, user_info_array;\n                    return _regeneratorRuntime.wrap(function _callee$(_context) {\n                      while (1) {\n                        switch (_context.prev = _context.next) {\n                          case 0:\n                            poolName = _ref2.poolName, rewardRate = _ref2.rewardRate, lockPeriod = _ref2.lockPeriod, totalStaked = _ref2.totalStaked;\n                            user_info = \"0\";\n                            user_amount = \"0\";\n                            user_reward = \"0\";\n\n                            if (!account) {\n                              _context.next = 11;\n                              break;\n                            }\n\n                            _context.next = 7;\n                            return staking.getStakeholderInfo(id, account).toString();\n\n                          case 7:\n                            user_info = _context.sent;\n                            user_info_array = new Array();\n                            user_info_array = user_info.split(\" ,\");\n                            console.log(user_info_array);\n\n                          case 11:\n                            return _context.abrupt(\"return\", {\n                              name: poolName,\n                              rewardRate: rewardRate.toString(),\n                              lockPeriod: lockPeriod.toString(),\n                              totalStaked: totalStaked.toString(),\n                              id: id,\n                              user_info: user_info,\n                              user_reward: user_reward\n                            });\n\n                          case 12:\n                          case \"end\":\n                            return _context.stop();\n                        }\n                      }\n                    }, _callee);\n                  }));\n\n                  return function (_x2, _x3) {\n                    return _ref3.apply(this, arguments);\n                  };\n                }()));\n\n              case 2:\n                pools = _context2.sent;\n                dispatch(setPools(pools));\n\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  };\n}; // setPools is an action\n\nvar setPools = stakingSlice.actions.setPools;\nexport { setPools };\nexport default stakingSlice.reducer;","map":{"version":3,"sources":["C:/Users/Arshia Dhiman/Solidity-Staking-Project/staking-frontend/src/features/staking/stakingSlice.ts"],"names":["createSlice","STAKING_ADDRESS","ABI","getContract","initialState","pools","stakingSlice","name","reducers","setPools","state","action","payload","updatePools","account","dispatch","staking","getPools","then","_pools","Promise","all","map","id","poolName","rewardRate","lockPeriod","totalStaked","user_info","user_amount","user_reward","getStakeholderInfo","toString","user_info_array","Array","split","console","log","actions","reducer"],"mappings":";;AAAA,SACIA,WADJ,QAKO,kBALP;AASA,SAASC,eAAT,QAAgC,eAAhC;AACA,OAAOC,GAAP,MAAgB,sBAAhB;AACA,SAASC,WAAT,QAA4B,WAA5B,C,CAEA;;AAKA;AACA,IAAMC,YAA0B,GAAG;AAC/BC,EAAAA,KAAK,EAAE;AADwB,CAAnC;AAIA,OAAO,IAAMC,YAAY,GAAGN,WAAW,CAAC;AACpCO,EAAAA,IAAI,EAAE,SAD8B;AAEpC;AACAH,EAAAA,YAAY,EAAZA,YAHoC;AAIpCI,EAAAA,QAAQ,EAAE;AACNC,IAAAA,QAAQ,EAAE,kBAACC,KAAD,EAAQC,MAAR,EAA0C;AAChDD,MAAAA,KAAK,CAACL,KAAN,GAAcM,MAAM,CAACC,OAArB;AACH;AAHK;AAJ0B,CAAD,CAAhC,C,CAWP;;AACA,OAAO,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,OAAD,EAAsB;AAC7C,SAAO,UAACC,QAAD,EAA4D;AAC/D,QAAMC,OAAO,GAAGb,WAAW,CAACF,eAAD,EAAkBC,GAAlB,CAA3B,CAD+D,CAE/D;;AACAc,IAAAA,OAAO,CAACC,QAAR,GAAmBC,IAAnB;AAAA,0EAAwB,kBAAOC,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACAC,OAAO,CAACC,GAAR,CAChBF,MAAM,CAACG,GAAP;AAAA,uFACI,wBAEIC,EAFJ;AAAA;AAAA;AAAA;AAAA;AAAA;AACMC,4BAAAA,QADN,SACMA,QADN,EACgBC,UADhB,SACgBA,UADhB,EAC4BC,UAD5B,SAC4BA,UAD5B,EACwCC,WADxC,SACwCA,WADxC;AAIQC,4BAAAA,SAJR,GAIoB,GAJpB;AAKQC,4BAAAA,WALR,GAKsB,GALtB;AAMQC,4BAAAA,WANR,GAMsB,GANtB;;AAAA,iCAQQhB,OARR;AAAA;AAAA;AAAA;;AAAA;AAAA,mCAS0BE,OAAO,CACpBe,kBADa,CACMR,EADN,EACUT,OADV,EAEbkB,QAFa,EAT1B;;AAAA;AASQJ,4BAAAA,SATR;AAYYK,4BAAAA,eAZZ,GAY8B,IAAIC,KAAJ,EAZ9B;AAaQD,4BAAAA,eAAe,GAAGL,SAAS,CAACO,KAAV,CAAgB,IAAhB,CAAlB;AACAC,4BAAAA,OAAO,CAACC,GAAR,CAAYJ,eAAZ;;AAdR;AAAA,6DAiBW;AACH1B,8BAAAA,IAAI,EAAEiB,QADH;AAEHC,8BAAAA,UAAU,EAAEA,UAAU,CAACO,QAAX,EAFT;AAGHN,8BAAAA,UAAU,EAAEA,UAAU,CAACM,QAAX,EAHT;AAIHL,8BAAAA,WAAW,EAAEA,WAAW,CAACK,QAAZ,EAJV;AAKHT,8BAAAA,EAAE,EAAEA,EALD;AAMHK,8BAAAA,SAAS,EAATA,SANG;AAOHE,8BAAAA,WAAW,EAAXA;AAPG,6BAjBX;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADJ;;AAAA;AAAA;AAAA;AAAA,oBADgB,CADA;;AAAA;AACdzB,gBAAAA,KADc;AAiCpBU,gBAAAA,QAAQ,CAACN,QAAQ,CAACJ,KAAD,CAAT,CAAR;;AAjCoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAxB;;AAAA;AAAA;AAAA;AAAA;AAmCH,GAtCD;AAuCH,CAxCM,C,CA0CP;;IACeI,Q,GAAaH,YAAY,CAACgC,O,CAA1B7B,Q;;AAEf,eAAeH,YAAY,CAACiC,OAA5B","sourcesContent":["import {\n    createSlice,\n    PayloadAction,\n    ThunkDispatch,\n    Action,\n} from \"@reduxjs/toolkit\";\nimport { RootState } from \"@src/store\";\nimport { Pool } from \"@ts/interfaces\";\n\nimport { STAKING_ADDRESS } from \"src/constants\";\nimport ABI from \"src/abi/Staking.json\";\nimport { getContract } from \"src/utils\";\n\n// Define a type for the slice state\ninterface StakingState {\n    pools: Pool[];\n}\n\n// Define the initial state using that type\nconst initialState: StakingState = {\n    pools: [],\n};\n\nexport const stakingSlice = createSlice({\n    name: \"staking\",\n    // `createSlice` will infer the state type from the `initialState` argument\n    initialState,\n    reducers: {\n        setPools: (state, action: PayloadAction<Pool[]>) => {\n            state.pools = action.payload;\n        },\n    },\n});\n\n// whatever function the thunk returns should use .then (can't await)\nexport const updatePools = (account?: string) => {\n    return (dispatch: ThunkDispatch<RootState, void, Action>): void => {\n        const staking = getContract(STAKING_ADDRESS, ABI);\n        // eslint-disable-next-line\n        staking.getPools().then(async (_pools: any[]) => {\n            const pools = await Promise.all(\n                _pools.map(\n                    async (\n                        { poolName, rewardRate, lockPeriod, totalStaked },\n                        id,\n                    ) => {\n                        let user_info = \"0\";\n                        let user_amount = \"0\";\n                        let user_reward = \"0\";\n\n                        if (account) {\n                            user_info = await staking\n                                .getStakeholderInfo(id, account)\n                                .toString();\n                            let user_info_array = new Array();\n                            user_info_array = user_info.split(\" ,\");\n                            console.log(user_info_array);\n                        }\n\n                        return {\n                            name: poolName,\n                            rewardRate: rewardRate.toString(),\n                            lockPeriod: lockPeriod.toString(),\n                            totalStaked: totalStaked.toString(),\n                            id: id,\n                            user_info,\n                            user_reward,\n                        };\n                    },\n                ),\n            );\n\n            dispatch(setPools(pools));\n        });\n    };\n};\n\n// setPools is an action\nexport const { setPools } = stakingSlice.actions;\n\nexport default stakingSlice.reducer;\n"]},"metadata":{},"sourceType":"module"}